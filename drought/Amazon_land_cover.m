% this is to get the land cover map for the Amazon region

%clear;
%clc;

LC_path = '/projectnb/landsat/users/parevalo/ge529/MCD12C1.051/'; % path to your MCD12C1 data

year_i = 2006;
        
LC_file_dir = dir(strcat(LC_path,'MCD12C1.A',num2str(year_i),'*.hdf'));

LC_file_name = LC_file_dir(1).name;

land_cover = hdfread(strcat(LC_path,LC_file_name),...
    '/MOD12C1/Data Fields/Majority_Land_Cover_Type_1', 'Index', {[1  1],[1  1],[3600  7200]});

LC_Amazon = land_cover(1601:2200,2001:2700);

LC_Amazon_aggreg = uint8(ones(600,700));

LC_Amazon_aggreg = LC_Amazon_aggreg*4; % non-vegetation

LC_Amazon_aggreg(LC_Amazon<15 & LC_Amazon~=13)=3; % other vegetation
LC_Amazon_aggreg(LC_Amazon>7 & LC_Amazon<10)=2; % savannas
LC_Amazon_aggreg(LC_Amazon>0 & LC_Amazon<6)=1; % forests
LC_Amazon_aggreg(LC_Amazon==0)=0; % water

save('LC_Amazon_aggreg.mat','LC_Amazon_aggreg');


cmap = [130,163,214;...
    24,141,0;...
    254,251,2;...
    82,246,121;...
    145,85,0];

cmap = cmap./255;

fig = figure('Color','white','PaperSize',[6.0 4.5]);

Rlatlon = makerefmat('RasterSize', [600 700], ...
        'Latlim', [-20 10], 'Lonlim', [-80 -45]);
    
ax = axesm('mapprojection','pcarree','grid','on','glinewidth',1,'geoid',[6371007.181 0],...
    'maplatlimit',[-20 10],'maplonlimit',[-80 -45],'frame','on',...
'plinelocation',10,'mlinelocation',10,...
    'mlabelparallel','south');

axis off;

LC_Amazon_geo = flipud(LC_Amazon_aggreg);


geoshow(LC_Amazon_geo, Rlatlon, 'DisplayType', 'texturemap')
colormap(cmap);

load coast;
geoshow(lat,long,'Color',[0.35 0.35 0.35]);


% Create textbox
annotation(fig,'textbox',...
    [0.185 0.570 0.090 0.078],...
    'String',{'0^{\circ}'},...
    'FontSize',12,...
    'LineStyle','none');
% Create textbox
annotation(fig,'textbox',...
    [0.813 0.570 0.090 0.078],...
    'String',{'0^{\circ}'},...
    'FontSize',12,...
    'LineStyle','none');
% Create textbox
annotation(fig,'textbox',...
    [0.153 0.345 0.125 0.078],...
    'String',{'10^{\circ}S'},...
    'FontSize',12,...
    'LineStyle','none');
% Create textbox
annotation(fig,'textbox',...
    [0.813 0.345 0.125 0.078],...
    'String',{'10^{\circ}S'},...
    'FontSize',12,...
    'LineStyle','none');
% Create textbox
annotation(fig,'textbox',...
    [0.153 0.797 0.125 0.078],...
    'String',{'10^{\circ}N'},...
    'FontSize',12,...
    'LineStyle','none');
% Create textbox
annotation(fig,'textbox',...
    [0.692 0.093 0.133 0.078],...
    'String',{'50^{\circ}W'},...
    'FontSize',12,...
    'LineStyle','none');
% Create textbox
annotation(fig,'textbox',...
    [0.520 0.093 0.133 0.078],...
    'String',{'60^{\circ}W'},...
    'FontSize',12,...
    'LineStyle','none');
% Create textbox
annotation(fig,'textbox',...
    [0.350 0.093 0.133 0.078],...
    'String',{'70^{\circ}W'},...
    'FontSize',12,...
    'LineStyle','none');
% Create textbox
annotation(fig,'textbox',...
    [0.185 0.093 0.133 0.078],...
    'String',{'80^{\circ}W'},...
    'FontSize',12,...
    'LineStyle','none');
% Create textbox
annotation(fig,'textbox',...
    [0.692 0.817 0.133 0.078],...
    'String',{'50^{\circ}W'},...
    'FontSize',12,...
    'LineStyle','none');
% Create textbox
annotation(fig,'textbox',...
    [0.520 0.817 0.133 0.078],...
    'String',{'60^{\circ}W'},...
    'FontSize',12,...
    'LineStyle','none');
% Create textbox
annotation(fig,'textbox',...
    [0.350 0.817 0.133 0.078],...
    'String',{'70^{\circ}W'},...
    'FontSize',12,...
    'LineStyle','none');

% hcb = colorbar('location','southoutside','XLim',[0 4],'XTick',0:4/5:4,'XTickLabel',{},...
%     'TickLength',[0.05 0.05],'XColor','k','YColor','k');
    
filename = 'LC_Amazon';
% print(fig,'-dpng','-r600',filename);

